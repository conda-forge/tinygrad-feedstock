From 6ba4e3be8f6e1bbf4a220d38fbf5cac8e6d241ed Mon Sep 17 00:00:00 2001
From: "H. Vetinari" <h.vetinari@gmx.com>
Date: Fri, 26 Dec 2025 10:46:26 +1100
Subject: [PATCH 3/9] use our standard macos sdk

---
 tinygrad/runtime/autogen/__init__.py | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/tinygrad/runtime/autogen/__init__.py b/tinygrad/runtime/autogen/__init__.py
index 3af6408d4..8542f3aeb 100644
--- a/tinygrad/runtime/autogen/__init__.py
+++ b/tinygrad/runtime/autogen/__init__.py
@@ -10,7 +10,8 @@ nv_src = {"nv_570": "https://github.com/NVIDIA/open-gpu-kernel-modules/archive/8
           "nv_580": "https://github.com/NVIDIA/open-gpu-kernel-modules/archive/2af9f1f0f7de4988432d4ae875b5858ffdb09cc2.tar.gz"}
 ffmpeg_src = "https://ffmpeg.org/releases/ffmpeg-8.0.1.tar.gz"
 rocr_src = "https://github.com/ROCm/rocm-systems/archive/refs/tags/rocm-7.1.1.tar.gz"
-macossdk = "/var/db/xcode_select_link/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk"
+CONDA_BUILD_SYSROOT = os.environ.get('CONDA_BUILD_SYSROOT', None)
+macossdk = "/var/db/xcode_select_link/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk" if CONDA_BUILD_SYSROOT is None else CONDA_BUILD_SYSROOT
 
 llvm_lib = CONDA_PREFIX/(r"bin\LLVM-C.dll" if WIN else f"lib/libLLVM.{'dylib' if OSX else 'so'}")
 clang_lib = CONDA_PREFIX/(r"bin\libclang-13.dll" if WIN else f"lib/libclang.{'dylib' if OSX else 'so'}")
