From cce69e02effc4ca16a62d0b298e0f1362c292e87 Mon Sep 17 00:00:00 2001
From: George Hotz <72895+geohot@users.noreply.github.com>
Date: Tue, 7 Oct 2025 10:42:22 +0800
Subject: [PATCH 2/2] move frontend dir to nn [pr] (#12470)

---
 examples/benchmark_onnx.py                    | 2 +-
 examples/compile_tensorflow.py                | 2 +-
 examples/openpilot/compile3.py                | 2 +-
 examples/other_mnist/beautiful_mnist_torch.py | 2 +-
 examples/yolov8-onnx.py                       | 2 +-
 extra/huggingface_onnx/run_models.py          | 2 +-
 extra/onnx_helpers.py                         | 2 +-
 extra/torch_backend/test_inplace.py           | 2 +-
 extra/torch_backend/test_multigpu.py          | 2 +-
 test/external/external_benchmark_openpilot.py | 2 +-
 test/external/external_model_benchmark.py     | 2 +-
 test/external/external_test_onnx_ops.py       | 2 +-
 test/models/test_onnx.py                      | 2 +-
 test/test_ops.py                              | 2 +-
 test/test_quantize_onnx.py                    | 2 +-
 tinygrad/frontend/__init__.py                 | 0
 tinygrad/{frontend => nn}/onnx.py             | 0
 tinygrad/{frontend => nn}/torch.py            | 0
 18 files changed, 15 insertions(+), 15 deletions(-)
 delete mode 100644 tinygrad/frontend/__init__.py
 rename tinygrad/{frontend => nn}/onnx.py (100%)
 rename tinygrad/{frontend => nn}/torch.py (100%)

diff --git a/examples/benchmark_onnx.py b/examples/benchmark_onnx.py
index e88033bd0..f4d0c646e 100644
--- a/examples/benchmark_onnx.py
+++ b/examples/benchmark_onnx.py
@@ -1,6 +1,6 @@
 import sys, onnx, time, pickle
 from tinygrad import TinyJit, GlobalCounters, fetch, getenv
-from tinygrad.frontend.onnx import OnnxRunner
+from tinygrad.nn.onnx import OnnxRunner
 from extra.onnx_helpers import get_example_inputs, validate
 
 def load_onnx_model(onnx_file):
diff --git a/examples/compile_tensorflow.py b/examples/compile_tensorflow.py
index 3ad6f3119..349afa030 100644
--- a/examples/compile_tensorflow.py
+++ b/examples/compile_tensorflow.py
@@ -8,7 +8,7 @@ import numpy as np
 import subprocess
 import tensorflow as tf
 import tf2onnx
-from tinygrad.frontend.onnx import OnnxRunner
+from tinygrad.nn.onnx import OnnxRunner
 from tinygrad.tensor import Tensor
 from extra.export_model import export_model_clang, compile_net, jit_model
 
diff --git a/examples/openpilot/compile3.py b/examples/openpilot/compile3.py
index 476d40725..1b1cccba8 100644
--- a/examples/openpilot/compile3.py
+++ b/examples/openpilot/compile3.py
@@ -12,7 +12,7 @@ from tinygrad.engine.realize import CompiledRunner
 
 import onnx
 from onnx.helper import tensor_dtype_to_np_dtype
-from tinygrad.frontend.onnx import OnnxRunner
+from tinygrad.nn.onnx import OnnxRunner
 
 OPENPILOT_MODEL = sys.argv[1] if len(sys.argv) > 1 else "https://github.com/commaai/openpilot/raw/v0.9.7/selfdrive/modeld/models/supercombo.onnx"
 OUTPUT = sys.argv[2] if len(sys.argv) > 2 else "/tmp/openpilot.pkl"
diff --git a/examples/other_mnist/beautiful_mnist_torch.py b/examples/other_mnist/beautiful_mnist_torch.py
index fb3c547aa..8e0b7dd64 100644
--- a/examples/other_mnist/beautiful_mnist_torch.py
+++ b/examples/other_mnist/beautiful_mnist_torch.py
@@ -27,7 +27,7 @@ class Model(nn.Module):
 
 if __name__ == "__main__":
   if getenv("TINY_BACKEND"):
-    import tinygrad.frontend.torch
+    import tinygrad.nn.torch  # noqa: F401
     device = torch.device("tiny")
   else:
     device = torch.device({"METAL":"mps","NV":"cuda"}.get(Device.DEFAULT, "cpu"))
diff --git a/examples/yolov8-onnx.py b/examples/yolov8-onnx.py
index 9d1402454..f23e12c0c 100644
--- a/examples/yolov8-onnx.py
+++ b/examples/yolov8-onnx.py
@@ -3,7 +3,7 @@ import os
 from ultralytics import YOLO
 import onnx
 from pathlib import Path
-from tinygrad.frontend.onnx import OnnxRunner
+from tinygrad.nn.onnx import OnnxRunner
 from extra.onnx_helpers import get_example_inputs
 from tinygrad.tensor import Tensor
 
diff --git a/extra/huggingface_onnx/run_models.py b/extra/huggingface_onnx/run_models.py
index c81952216..870267ecd 100644
--- a/extra/huggingface_onnx/run_models.py
+++ b/extra/huggingface_onnx/run_models.py
@@ -1,6 +1,6 @@
 import onnx, yaml, tempfile, time, collections, pprint, argparse, json
 from pathlib import Path
-from tinygrad.frontend.onnx import OnnxRunner
+from tinygrad.nn.onnx import OnnxRunner
 from extra.onnx import get_onnx_ops
 from extra.onnx_helpers import validate, get_example_inputs
 
diff --git a/extra/onnx_helpers.py b/extra/onnx_helpers.py
index ab020fdb2..a26b5d088 100644
--- a/extra/onnx_helpers.py
+++ b/extra/onnx_helpers.py
@@ -1,6 +1,6 @@
 from tinygrad import Tensor
 from tinygrad.tensor import _to_np_dtype
-from tinygrad.frontend.onnx import OnnxRunner
+from tinygrad.nn.onnx import OnnxRunner
 from extra.onnx import OnnxValue
 import onnx
 import numpy as np
diff --git a/extra/torch_backend/test_inplace.py b/extra/torch_backend/test_inplace.py
index e6f171f05..788f8d2eb 100644
--- a/extra/torch_backend/test_inplace.py
+++ b/extra/torch_backend/test_inplace.py
@@ -1,6 +1,6 @@
 import unittest
 import torch
-import tinygrad.frontend.torch
+import tinygrad.nn.torch
 torch.set_default_device("tiny")
 import numpy as np
 
diff --git a/extra/torch_backend/test_multigpu.py b/extra/torch_backend/test_multigpu.py
index 9a2189813..cff18bf2a 100644
--- a/extra/torch_backend/test_multigpu.py
+++ b/extra/torch_backend/test_multigpu.py
@@ -1,7 +1,7 @@
 import unittest
 from tinygrad.helpers import getenv
 import torch
-import tinygrad.frontend.torch
+import tinygrad.nn.torch
 torch.set_default_device("tiny")
 import numpy as np
 
diff --git a/test/external/external_benchmark_openpilot.py b/test/external/external_benchmark_openpilot.py
index 910d8a5ed..e9743788a 100644
--- a/test/external/external_benchmark_openpilot.py
+++ b/test/external/external_benchmark_openpilot.py
@@ -2,7 +2,7 @@ import time, sys, hashlib
 from pathlib import Path
 import onnx
 from onnx.helper import tensor_dtype_to_np_dtype
-from tinygrad.frontend.onnx import OnnxRunner
+from tinygrad.nn.onnx import OnnxRunner
 from tinygrad import Tensor, dtypes, TinyJit
 from tinygrad.helpers import IMAGE, GlobalCounters, fetch, colored, getenv, trange
 from tinygrad.tensor import _from_np_dtype
diff --git a/test/external/external_model_benchmark.py b/test/external/external_model_benchmark.py
index 5b1199e1e..0babc0ad9 100644
--- a/test/external/external_model_benchmark.py
+++ b/test/external/external_model_benchmark.py
@@ -6,7 +6,7 @@ import onnx
 from onnx.helper import tensor_dtype_to_np_dtype
 import onnxruntime as ort
 from onnx2torch import convert
-from tinygrad.frontend.onnx import OnnxRunner
+from tinygrad.nn.onnx import OnnxRunner
 from tinygrad.helpers import OSX, DEBUG, fetch
 from tinygrad import Tensor, Device
 from tinygrad.device import CompileError
diff --git a/test/external/external_test_onnx_ops.py b/test/external/external_test_onnx_ops.py
index adc63edda..ff22d1708 100644
--- a/test/external/external_test_onnx_ops.py
+++ b/test/external/external_test_onnx_ops.py
@@ -5,7 +5,7 @@
 from typing import Any
 import unittest, onnx, tempfile
 from tinygrad import dtypes
-from tinygrad.frontend.onnx import OnnxRunner
+from tinygrad.nn.onnx import OnnxRunner
 import numpy as np
 from extra.onnx_helpers import validate
 
diff --git a/test/models/test_onnx.py b/test/models/test_onnx.py
index d1b7def35..6d1754ae8 100644
--- a/test/models/test_onnx.py
+++ b/test/models/test_onnx.py
@@ -7,7 +7,7 @@ try:
   import onnx
 except ModuleNotFoundError:
   raise unittest.SkipTest("onnx not installed, skipping onnx test")
-from tinygrad.frontend.onnx import OnnxRunner
+from tinygrad.nn.onnx import OnnxRunner
 from tinygrad.tensor import Tensor
 from tinygrad.helpers import CI, fetch, temp
 
diff --git a/test/test_ops.py b/test/test_ops.py
index e0ddc66fc..442c704bd 100644
--- a/test/test_ops.py
+++ b/test/test_ops.py
@@ -9,7 +9,7 @@ from tinygrad.tensor import _to_np_dtype
 from tinygrad.device import is_dtype_supported
 
 if getenv("TINY_BACKEND"):
-  import tinygrad.frontend.torch # noqa: F401 # pylint: disable=unused-import
+  import tinygrad.nn.torch # noqa: F401 # pylint: disable=unused-import
   torch.set_default_device("tiny")
 
 if CI:
diff --git a/test/test_quantize_onnx.py b/test/test_quantize_onnx.py
index 0c1492b56..cfac46817 100644
--- a/test/test_quantize_onnx.py
+++ b/test/test_quantize_onnx.py
@@ -70,7 +70,7 @@ class TestQuantizeOnnxCPU(unittest.TestCase):
       import onnx
     except ImportError:
       raise unittest.SkipTest()
-    from tinygrad.frontend.onnx import OnnxRunner
+    from tinygrad.nn.onnx import OnnxRunner
     out_file = get_quantized_model(sz)
     onnx_model = onnx.load(out_file)
     run_onnx = OnnxRunner(onnx_model)
diff --git a/tinygrad/frontend/__init__.py b/tinygrad/frontend/__init__.py
deleted file mode 100644
index e69de29bb..000000000
diff --git a/tinygrad/frontend/onnx.py b/tinygrad/nn/onnx.py
similarity index 100%
rename from tinygrad/frontend/onnx.py
rename to tinygrad/nn/onnx.py
diff --git a/tinygrad/frontend/torch.py b/tinygrad/nn/torch.py
similarity index 100%
rename from tinygrad/frontend/torch.py
rename to tinygrad/nn/torch.py
